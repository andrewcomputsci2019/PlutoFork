syntax = "proto3";

message ErrorResponse {
  enum ErrorType {
    SERVER_ERROR = 0;
    PUBKEY_LENGTH_INVALID = 1;
    CHALLENGE_RESPONSE_INVALID = 2;
    SESSION_INVALID = 3;
  };
  ErrorType error = 2;
  string message = 3;
}

message EncryptedMessage {
  bytes ephemeral_pubkey = 1;
  bytes sender_pubkey = 2;
  bytes salt = 3;
  bytes nonce = 4;
  bytes inner_message = 5;
}
